{% extends 'base.html' %}

{% block title %}
  Page de connexion
{% endblock %}

{% block content %}
  {% if user.is_authenticated %}

  {% else %}

  {% endif %}
  <div class="container py-5">
    <!-- Présentation du coach -->
    <div class="text-center mb-5">
      <h1 class="display-4">Page de Connexion</h1>
    </div>

    <!-- Formulaire de connexion -->
    <section class="mb-5">
      <form method="post">
        {% csrf_token %}

        {% for field in form %}
          <div class="mb-3">
            {{ field.label_tag }}
            {{ field }}
            {% if field.errors %}
              <div class="text-danger small">{{ field.errors|striptags }}</div>
            {% endif %}
          </div>
        {% endfor %}

        <button type="submit" class="btn btn-primary">Se connecter</button>
      </form>
    </section>

    <!-- Messages d'erreur -->
    <section class="mb-5">
      <!-- TOAST Bootstrap -->
      {% for message in messages %}
        {% if message.tags == 'error' %}
          <div class="toast align-items-center text-white bg-danger border-0 show" role="alert">
            <div class="d-flex">
              <div class="toast-body">{{ message }}</div>
              <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Fermer"></button>
            </div>
          </div>
        {% endif %}
      {% endfor %}

      <script>
        // Auto-hide toasts après 3 secondes
        document.addEventListener('DOMContentLoaded', function () {
          const toastElList = [].slice.call(document.querySelectorAll('.toast.bg-danger'))
          toastElList.forEach(function (toastEl) {
            const toast = new bootstrap.Toast(toastEl, { delay: 2500 })
            toast.show()
          })
        })
      </script>
    </section>
  </div>
{% endblock %}
